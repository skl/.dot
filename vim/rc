" vim: ft=vim fdm=marker ts=4 sts=4 sw=4 fdl=0

" startup/global general settings {{{
set nocompatible
set modelines=5
set shortmess +=I
set noswapfile
set ttyfast
set showcmd
set history=1000
set clipboard=unnamed
set switchbuf=useopen
set hidden
set visualbell t_vb=
set novisualbell
set nu
set ruler
set foldcolumn=2
set foldmethod=marker
"}}}

" neobundle {{{
set rtp+=~/.vim/bundle/neobundle.vim
call neobundle#rc(expand('~/.vim/bundle/'))
NeoBundleFetch 'Shougo/neobundle.vim'
"}}}

" keyboard/mouse general settings {{{
set mouse=a
set backspace=indent,eol,start
set listchars=tab:▸\ ,eol:¬
if has('mouse_sgr')
    set ttymouse=sgr
endif
"}}}

" indentation and syntax highlighting {{{
filetype plugin indent on
syntax on
set hlsearch
set ai
set expandtab
set smarttab
set shiftwidth=4
set tabstop=4
set shiftwidth=4
set textwidth=0
set wrapmargin=0
set encoding=utf-8
set cursorline
autocmd WinLeave * setlocal nocursorline
autocmd WinEnter * setlocal cursorline
set colorcolumn=120
set cursorcolumn
autocmd WinLeave * setlocal nocursorcolumn
autocmd WinEnter * setlocal cursorcolumn
"}}}

" functions {{{
function! <SID>StripTrailingWhitespaces()
    " Preparation: save last search, and cursor position.
    let _s=@/
    let l = line(".")
    let c = col(".")
    " Do the business:
    %s/\s\+$//e
    " Clean up: restore previous search history, and cursor position
    let @/=_s
    call cursor(l, c)
endfunction
"}}}

" filetype specifics {{{
autocmd FileType make setlocal ts=8 sts=8 sw=8 noexpandtab
autocmd FileType yaml setlocal ts=2 sts=2 sw=2 expandtab

"autocmd FileType javascript setlocal ts=4 sts=4 sw=4 noexpandtab

" map file extensions to type
autocmd BufNewFile,BufRead *.rss,*.atom setfiletype xml

autocmd BufWritePre *.py,*.js,*.php,*.html,*.htm :call <SID>StripTrailingWhitespaces()
"}}}

NeoBundleLazy 'scrooloose/nerdtree', {'autoload':{'commands':['NERDTreeToggle','NERDTreeFind']}} "{{{
    let NERDTreeShowHidden=1
    let NERDTreeQuitOnOpen=0
    let NERDTreeShowLineNumbers=1
    let NERDTreeChDirMode=0
    let NERDTreeShowBookmarks=1
    let NERDTreeIgnore=['\.git','\.hg']
    let NERDTreeBookmarksFile='~/.vim/.cache/NERDTreeBookmarks'
"}}}

" colourscheme {{{
NeoBundle 'nanotech/jellybeans.vim'
colorscheme jellybeans
"}}}

" plugins {{{
NeoBundle 'tpope/vim-fugitive'
NeoBundle 'vim-scripts/taglist.vim'
"}}}

" keymaps {{{
nmap <leader>l :set list!<CR>   " toggle whitespace identifiers
nmap <leader><leader> za        " toggle fold open/close
nmap <leader>- zM               " close all folds
nmap <leader>= zR               " open all folds

nnoremap <F2> :NERDTreeToggle<CR>
nnoremap <F3> :NERDTreeFind<CR>
nnoremap <F5> :call <SID>StripTrailingWhitespaces()<CR>
"}}}
